<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socratic - AI Tutor</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=2">
    <!-- Using Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Highlight.js for Syntax Highlighting -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <!-- KaTeX for Math Rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
</head>

<body class="theme-midnight">
    <div class="app-container">
        <!-- Mobile Header (Visible only on small screens) -->
        <div class="mobile-header">
            <button class="btn-icon mobile-menu-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo-container mobile-logo">
                <i class="fas fa-columns logo-icon" style="font-size: 1.2rem;"></i>
                <h1 style="font-size: 1.2rem; margin: 0;">Socratic</h1>
            </div>
            <div style="width: 44px;"></div> <!-- Spacer for balance -->
        </div>

        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <i class="fas fa-columns logo-icon"></i>
                    <div>
                        <h1>Socratic-AI</h1>
                        <p>AI Tutor Agent</p>
                    </div>
                </div>
            </div>

            <!-- Sidebar Content Wrapper -->
            <div style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">

                <!-- Scrollable Section for Menu and History -->
                <div class="sidebar-scroll-area"
                    style="flex: 1; overflow-y: auto; padding-right: 5px; margin-bottom: 1rem;">
                    <div class="nav-section">
                        <h3>Menu</h3>
                        <a href="/new_chat" class="nav-item">
                            <i class="fas fa-plus"></i> New Chat
                        </a>
                        <a href="/chat"
                            class="nav-item {{ 'active' if request.path == '/chat' or request.path == '/' else '' }}">
                            <i class="fas fa-comments"></i> Current Chat
                        </a>
                        <a href="/dashboard" class="nav-item {{ 'active' if request.path == '/dashboard' else '' }}">
                            <i class="fas fa-chart-pie"></i> Dashboard
                        </a>
                    </div>

                    <div class="nav-section" id="history-section">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="margin-bottom: 0;">Recent Lessons</h3>
                            <button onclick="clearHistory()"
                                style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 0.7rem; opacity: 0.7;">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                        </div>
                        <!-- History items will be injected here via JS -->
                        <div id="history-list"></div>
                    </div>
                </div>

                <!-- Fixed Settings Section at Bottom -->
                <div class="nav-section"
                    style="border-top: 1px solid var(--border-color); padding-top: 1.5rem; flex-shrink: 0;">
                    <h3>Settings</h3>

                    <div style="margin-bottom: 1rem;">
                        <label
                            style="display: block; color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 0.5rem; padding-left: 1rem;">LANGUAGE</label>
                        <select id="language-select" class="nav-item"
                            style="appearance: none; background: var(--bg-tertiary); border: 1px solid var(--border-color); padding-right: 2rem;">
                            <option value="English">English</option>
                            <option value="Hindi">Hindi</option>
                            <option value="Tamil">Tamil</option>
                            <option value="Telugu">Telugu</option>
                        </select>
                    </div>

                    <button id="theme-toggle" class="nav-item">
                        <i class="fas fa-adjust"></i> Toggle Theme
                    </button>

                    <label class="nav-item" style="cursor: pointer; justify-content: space-between;">
                        <span><i class="fas fa-user-secret"></i> Temp Mode</span>
                        <input type="checkbox" id="temp-mode-toggle" onchange="toggleTempMode(this)">
                    </label>

                    <button class="nav-item" onclick="exportPDF()">
                        <i class="fas fa-file-pdf"></i> Export PDF
                    </button>
                </div>
            </div>

            <!-- Resizer Handle -->
            <div class="resizer"></div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            {% block content %}{% endblock %}
        </main>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/recorder.js') }}"></script>
</body>

</html>